<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>r2/header-scroller.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Detabinator.html">Detabinator</a></li><li><a href="HeaderScroller.html">HeaderScroller</a></li><li><a href="SideNav.html">SideNav</a></li><li><a href="TransformMenuAt.html">TransformMenuAt</a><ul class='methods'><li data-type='method'><a href="TransformMenuAt.html#swapHeader">swapHeader</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#upgrade">upgrade</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">r2/header-scroller.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>class HeaderScroller {
  /**
   * `HeaderScroller` is a class that listens to `iframeEl`'s contentWindow scroll event and scrolls the `reportalHeaderHTMLElement` when the iframeEl is scrolled
   * @param {Window} contentWindow - iframeEl.contentWindow
   * @param {HTMLElement} reportalHeaderHTMLElement - reportalHeaderHTMLElement element that needs to be scrolled
   * */
  constructor(contentWindow, reportalHeaderHTMLElement) {
    contentWindow.requestAnimationFrame =
      contentWindow.requestAnimationFrame
      || contentWindow.mozRequestAnimationFrame
      || contentWindow.webkitRequestAnimationFrame
      || contentWindow.msRequestAnimationFrame;

    this._meta  = {
      topOffset    : null,
      ticking      : false,
      offsetHeight : null,
      header       : null,
      lastScrollY  : 0,
      contentWindow: contentWindow
    };
    this.header = reportalHeaderHTMLElement;
    this._scrollCallback = this._scrollCallback.bind(this);
    this.attachListeners();
  }

  get header() {
    return this._meta.header;
  }

  set header(headerElement) {
    let offset;
    if (this.header != null) {
      this._meta.topOffset = this.headerTopOffset;
      this._resetHeader();
    }
    this._meta.header       = headerElement;
    this._meta.offsetHeight = headerElement.offsetHeight;
    this._configureHeader();
    this._setHeaderOffsetInIframe();
  }

  get headerTopOffset() {
    return this.header.style.top;
  }

  _resetHeader() {
    const header = this.header;
    header.classList.remove('scrollable-header');
    header.style.top = "";
   // this.detachListeners();
  }

  _configureHeader() {
    const header = this.header;
    header.classList.add('scrollable-header');
    header.style.top = this._meta.topOffset;
  }

  _setHeaderOffsetInIframe() {
    const iframeBody           = this._meta.contentWindow.document.querySelector('body');
    iframeBody.style.paddingTop = this._meta.offsetHeight + "px";
  }

  requestTick(callback) {
    if (!this._meta.ticking) {
      requestAnimationFrame(callback);
      this._meta.ticking = true;
    }
  }

  attachListeners() {
    this._meta.contentWindow.addEventListener("scroll", this._scrollFixed.bind(this), false);
  }

  detachListeners() {
    this._meta.contentWindow.removeEventListener("scroll", this._scrollFixed);
  }

  _scrollFixed() {
    this._meta.lastScrollY = this._meta.contentWindow.pageYOffset;
    this.requestTick(this._scrollCallback);
  }

  _scrollCallback() {
    let offset            = this._meta.lastScrollY;
    this.header.style.top = -offset + 'px';
    this._meta.ticking    = false;
  }
}

export default HeaderScroller
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Fri Mar 24 2017 13:19:53 GMT+0300 (Russia TZ 2 Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
